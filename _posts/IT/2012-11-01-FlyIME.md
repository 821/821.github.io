---
layout: horizontal
title: 小議輸入法碼表構成
tags:
- 電腦
- 斯文
categories:
- 挨踢
- 自選集
date: 2012/11/01 16:48:00
---
（本文繼續發揮我一貫的特點：長於理論，弱於實踐。）  
我是每天打字量基本上都破千，有時近萬的人，因此輸入法對我來說非常之重要，是電腦上最重要的一個軟件。但問題在於，目前還沒有任何一款輸入法和一款輸入模式讓我感到非常滿意。  
之前我寫過兩篇討論輸入法的文章，不過其中關注的輸入法，現在祇關注一個 QQ 拼音了。 QQ 拼音確實是安逸的輸入法，我使用小鶴雙拼方案+智能 ABC 筆劃+造詞功能，感到還算便捷。不過 QQ 拼音有幾個問題我難以迴避：第一，不是原生的繁體輸入法，而是使用函數轉換獲得繁體，因而其繁體字或有用錯。第二，沒有 Linux 版。第三，是騰訊公司出品，可能受到監控（搞得我每次打點什麼東西都想着要不要切換到別的輸入法）。第四，不支持 asdfghjkl; 選字。帶着這些問題，我繼續尋找輸入法。  
跳過尋找過程，反正我找到了兩個方案： rime 和 gcin/hime/OpenVanilla/雅虎奇摩。 gcin/hime/OpenVanilla/雅虎奇摩不是一個輸入法，是四個。他們基本上都是 OpenVanilla 及其衍生物。可共用碼表，都使用 .cin 來添加自己心儀的輸入方案。如果問我有什麼共同缺點，那就是繁體字不符合清代以上的習慣，而是臺灣標準。我的網站有很多異體字（而非正體字），就是長期使用各種該死輸入法造成的。 rime 是中國人開發的，但其繁體比臺灣的輸入法好，且比較方便調整詞頻、字頻。但他也有個毛病，就是由於是 one man 項目，人力資源不足，所以細節處理很差，一個「簡約式交互」功能，幾年了都做不出。  
不過不管是 rime 還是 gcin ，他們都是「輸入法平臺」，換言之，如果你對現有碼表不滿意，是可以肆意更換的。所以纔會引發我對製作碼表的討論。先前，我已經粗略的[討論](../imes)過音碼和形碼。現在我再來重申一下我的觀點：  
音碼的缺點：重碼率極高，有些方案的碼長略長。  
形碼的缺點：字根難記（嘸蝦米略好），拆字/取碼邏輯不科學甚至很隨意（鄭碼較好）。  
別看這些字根什麼的好像也就 26 個，其實每個鍵都對應好多部件，記憶量一般都有 200 以上。而且就算記得字根，也未必會拆字——比如自稱拆字合理的「張碼」，「曲」字拆成「冂」和「龷」——按新字形你要拆成「口」和「艹」或「日」和兩豎都是可能的，問題是輸入法的拆法跟你一不一樣。結果用形碼的人往往也不得不同時用音碼，譬如五筆用戶，很多人表示約 1-5% 不會拆，需用拼音。總之，形碼如果好記又好拆，說明你在用碼長恐怖的筆順碼。我覺得一篇標榜形碼的文章很好的反映了我的心態：  

> 可是，当一个科学实用的形码汉字输入法问世的时候，往往在文字学家面前倍遭非议。他们不习惯因而也不能容忍把汉字“拆开”。其实，在大科学时代，在“文理交汇”之际，我们对汉字的认识，也应当与时俱进。任何科学的汉字输入法，必然是传承与创新的结晶，如果仅仅用文字学的“要求”来评价并“束缚”汉字输入法，可以断定，我国将永远也不会有一个“形码”完全符合文字学的“标准”；继而，我们也将永远研究不出来一个高效实用的汉字输入法！事实表明，汉字依形进入电脑的唯一途径，就是把成千上万个汉字拆成部件，就像把不可计数的分子拆成数量有限的原子一样！汉字得以进入电脑，若对汉字的认识不作适应性的变革，那岂不是等于说：我们的祖先在创造汉字时，早已为计算机“作好准备”了吗？汉字自身的“规范”固然重要，但若不将汉字用科学的方法拆成“部件”，不创造新的规则，谁也不可能将数万个汉字按“字形”输入电脑！当汉字面临“灭顶之灾”的时候，只需对汉字的“认识”稍作变通，就能使汉字“活”下来，这才是大智慧！这才是硬道理！凭一科之偏对科学实用的“形码”一再非议，是有百害而无一利的。  

好吧，我就是固守規範，不與時俱進，不做適應性變革，不肯變通，沒有智慧，並且詛呪漢字死掉的人。反正我就是討厭現有形碼的拆字方式。順便吐槽一下這篇文章的作者，還是個狗屁工程院院士，居然說出「据了解我国大陆的中小学生对汉字和国学的认知，甚至落后于台湾和新加坡，这真是一件怪事。」這樣的話來，尼瑪你去過新加坡麼？還說「philips中的ph为什么要念“f”」來批評音碼，尼瑪語音動力學都沒學過，就好意思來討論英語中拼讀不一的現象，大言不慚，這種人的院士資格早該吊銷了，免得誤國誤民。  

另外，現有音碼與形碼幾乎全有個共同缺點：較少考慮手指的力氣問題，工作量分配不合理，助長鍵盤手形成。就我個人而言，我最不希望使用的是左手小指，最希望使用的是雙手的食指和右手中指，但食指最好是在 rfvujm 這幾個鍵位上，我把他們叫做正位。而 tgbyhn 雖然不算費力，但有點遠，比例高的話容易拖慢輸入速度，我把他們叫作副位，也儘量不要放太大的工作量。  

我希望有一款容易學，重碼率也不太高的輸入法，**不重復發明輪子**，全部取材於既有拆解方式（如果不基於既有方式，碼表也很難製作）。拆解過程應當符合這樣的理念：符合正常人對漢字的理解——倉頡檢字法提出，他的第一要務不是打得快，而是拆得合理，我表示認同這一觀念。另外，我對用鍵有很高要求，首碼必須僅使用 26 個英文字母來完成（不能像注音、行列那樣用到數字和標點，否則不利於標點符號快速輸入，也不能用其他按鍵，因爲太難按），而且儘量使用食指正位、中指、無名指。碼長最好固定，不要超過四，最好是三，打起來比較輕鬆。碼長爲三的編碼理論容量爲 4056 ，小於我的識字量，所以重碼在所難免，但祇要能達到拼音的 1/10 ，加上詞語組合，重碼也沒那麼可怕。  
一般人打字的時候心裏更多的是想字的讀音，而非形狀，又特別是全局的形狀，所以音碼還是基礎。而且，音碼我們已經有了兩套非常公認的碼表：漢語拼音和注音。學習音碼是非常輕鬆愉快的。  
音碼碼長的問題，事實上早已不存在。早期的微軟和智能 ABC 開闢了道路，接着自然、加加等逐步優化。現在有了舒服的小鶴，基本沒必要再出新花樣。對於難字不多且輸入法中未集成句子的情況（即進行一般創作的情況），我的小鶴雙拼輸入速度大概是 75/min ，並不比普通用形碼的慢。固定的碼長也有利於輸入長串中文，而不會出現「西安」和「仙」不分的問題。**音碼到了雙拼，可說是走到了盡頭。**形碼方面，卻還沒有一款好記又好拆的輸入法。  
但音形結合方面，往往不是太簡略，就是不好記——比如小鶴雙形，就不太好記。  
我們再回頭看看注音。注音的碼長爲 2-4 ，比漢語拼音的 1-6 合理。而且帶了聲調，重碼率大幅下降——特別是整詞輸入時，效果尤其明顯。去掉不常用的輕聲，對二字詞仍有 16 種組合。不過如果你一定要玩「近世進士盡是近視」這種惡趣味，我也沒有辦法——但也比「施氏食獅史」好吧？於是我想到了第一個雙拼升級方案：**小鶴聲調：碼長爲三，前兩碼用小鶴雙拼，最後一碼用 dfjkl 代表五種常用聲調。** dfjkl是鍵盤上最輕鬆的鍵位，選他們純粹是舒服而已。  
聲調衹有五種，而且輕聲很少，基本上依賴四種，重碼率太高。於是就有**小鶴入聲：在小鶴聲調的基礎上引入入聲系統，陰陽上去的入聲字放在 erui 上。**在這個創新之後，當然還可以做聲母方面的見精對立、幫並對立，或是韻母方面的天添對立，不過工作量較大，而且估計音韻學沒學好的人用不了這個廣韻級別的碼表。
完全基於發音的碼表，遇到「近世進士盡是近視」之類的變態，還是有很高的重碼率。於是我想起了智能 ABC 的形碼。其實他這套形碼還是不錯的，簡單易記，快速上手。與之類似的還有拼音加加的輔助碼。不過，由於二者都是閉源的，我無法獲得其碼表，還是不用了。那用什麼好？首先想到的是四角號碼——這是多位真正的中國學學者讚賞的方案，儘管多有不合理處，卻也算比較合理了。對於很多人而言，反正本來就會，不用再學，省去很多麻煩。而且，四角號碼異於形碼的一個地方是，他的拆字雖屬別創，並非固有，卻非常邏輯化，符合觀察者目光所及之處的。四角號碼基本上沒有哪個字難拆，爭議字也很少（當然前提是大家用的是同一字體，倘若你用宋體而我用隸書，那顯然我們在很多字上會拆得不一樣），衹要記住簡短的基本規則，不認識漢字的人都能拆，這是形碼做不到的。特別是如果不考慮附角的時候，四角號碼眞的很輕鬆。好了，這就是雙拼基於字型的升級方案：**小鶴四角：在小鶴雙拼的基礎上，像智能 ABC 一樣選擇性使用四角號碼的數字來降低重碼。**  
況且，敲數字對手指的壓力還是比較大的，所以我平時打雙拼也很少加形碼。如果把 1234567890 移到 asdfghjkl; ，那就舒服多了——這是很多臺灣輸入法的做法，不過是用在選字上。來吧，第三套方案：**小鶴一角：碼長爲三，前兩碼用小鶴雙拼，最後一碼取四角號碼的第一碼，並把 1234567890 映射到 asdfghjkl; 。**  
很顯然，三碼的小鶴聲調和小鶴一角都有一個毛病：第三碼很浪費。腫麼辦？再看我的**鶴調一角：碼長爲三，前兩碼用小鶴雙拼，最後一碼把四角號碼的 0 和 3 合併爲 3 ， 1 和 7 合併爲 7 ，然後映射到 qwert 鍵盤，平聲字用 sdfghjkl ，上聲字和輕聲字用 wertyuio ，去聲字用 xcvbnm,. 。**這個做法有點行列輸入法的思想在裏面，但是並不像行列那樣還是要背很多拆字及其邏輯。輕聲字和上聲字比較少就放一起，而且輕聲的調值一般是 31 或者 21 ，而上聲在句子中是 21 ，聽感比較接近。去聲字最多，所以獨佔一排，平聲字加起來的比例肯定最大，所以放在不用挪動手指的一排。這種把四角和聲調結合起來的方法是得到了行列輸入法的啟發，不過我的設計在鍵位上比他舒適，而且這個眞的不用拆字啊。這個方案的重碼率肯定不高了，拼音有四百多個有意義的組合，三古專業畢業的人四會字量在 5000-10000 區間內較多，攤下來重碼是 12-25 ，由於分佈不均勻，多的重碼會超過 50 。但鶴調一角加了第三碼共 24 種，就算遇到集中分佈，重碼一般能控制在 10 以內，也就是輸入法的一頁。對於兩字詞，本來帶聲調的兩字詞重碼率已經很低，還加上 64 種組合，簡直太難遇到重碼了——只要把一個合適自己的大詞庫掛上（比如我比較適合用一個普通繁體詞庫，加一個漢語大詞典詞庫，再加一個包含論孟荀老莊等常用典籍語句的詞庫），就不用管選字了。  
鶴調一角是一個考慮了小拇指力氣問題的方案，但我個人並不滿意。原因是四角號碼雖然是個還算科學的方案，但打字的時候聯想起來比較痛苦。比如口訣裏的「叉四插五」這一對，還有「方塊六」和「七角」，「八八」和「九小」，「三點捺」和「點下有橫是零頭」，想着打就容易搞混，衹有看着打比較不容易出錯。而且合併陰陽，在拼音方面顯得有點喫虧。所以又想出了**鶴調一角改：碼長爲三，前兩碼用小鶴雙拼，最後一碼把四角號碼的 0 和 3 合併爲 3 ， 4 和 5 合併爲 4 ， 6 和 7 合併爲 7 ， 8 和 9 合併爲 8 ， 1 移動到 9 。映射到 qwert 鍵盤，去聲用 sdfjkl ，陰平用 xcvm,. ，陽平用 weruio ，最後比較特殊的上聲用 bntghy 。**。不要看我浪費了一些鍵位，這衹是爲了打字比較多的時候小拇指能夠舒服一點。事實上我打字一久，左手小拇指一般就不用了，他的鍵位就交給無名指，這樣位移還是相當大的。  
鶴調一角當然是有重碼的，有沒有一個重碼更低的三碼好記方案？答案是肯定的。那就是**小鶴康熙：前兩碼用小鶴雙拼，最後一碼用康熙字典部首的小鶴雙拼首字母，多音部首取康熙字典解釋的第一種。**爲什麼不是小鶴倉頡、小鶴蝦米、小鶴五筆、小鶴鄭碼？因爲即使是最好拆的鄭碼，他也是「字根理論」構建的，不是書寫和查詢習慣的部首。而且，越是科學拆字的形碼，他的字根就越難記，並不舒服。但若改用我們熟悉的部首，就不存在拆字和字根問題，祇有用家會不會讀那個部首的問題——如果是識字量很大的雙拼用戶，根本就是零記憶量。我從自己的情況來看， 214 個部首，我本來就能讀對的有 175 個，剩下的也能猜對一半以上的聲母。不過小鶴康熙的重碼率高於鶴調一角，因爲部首的發音分佈不均勻。另外，小鶴康煕在指法上很難優化。  
不會四角號碼，識字量小？試試**小鶴筆順：前兩碼用小鶴雙拼，最後一碼用筆順五碼，但按鍵爲 dfjkl 。**  
嫌小鶴筆順的重碼率高？好吧，**小鶴雙順：前兩碼用小鶴雙拼，最後一碼用筆順的前兩筆，然後做九九表式疊加， hjklm 是橫區（首筆爲橫的字最多）， asdfg 是豎區， yuiop 是撇區， qwert 是點區， zxcvb 是折區，每個區再按橫豎撇點折的順序來排第二筆。**毛病是鍵位不夠舒服。  
有沒有舒服而且又以讀音和筆順結合，重碼率又低的呢？**鶴調筆順：前兩碼用小鶴雙拼，最後一碼用筆順與聲調的結合， hjkl 是橫區， sdfg 是豎區， yuio 是撇區（首筆爲撇的字第二多）， wert 是點區， xcvb 是折區，各區以無名指管陰平，中指管陽平（陽平的字比陰平多），食指正位管去聲（去聲字的比例是最大的），副位管上聲和輕聲（兩個加起來還不如陰平多）。**這個拆法的優勢在於非常直觀，因爲想着讀音和字的第一筆，有點寫字的感覺。而四角號碼的第一碼往往不是寫字順序的第一筆，適合看着拆，而非想着拆。
最後，其實我還有一個更加無聊的方案：**小鶴瞎搞：前兩碼用小鶴雙拼，最後一碼自由選擇是用四角號碼 (qwertyuiop) 或聲調 (dfjkl) 或筆順五碼 (xcvnm) 。**  
好了，這篇文章包含的方案從頭到尾都在討論一件事：一個三碼且前兩碼是小鶴雙拼的輸入法的第三碼到底要加什麼。  
什麼？你覺得三碼不過癮，要我出四碼？好，看着，**鶴調角筆：小鶴雙拼爲前二碼，第三碼的結合方式同鶴調一角，第四碼將筆順的第一筆與四角號碼的第二號結合起來，橫、豎放在 sdfghjkl 行，撇放 wertyuio 行，點、折放 xcvbnm,. 行。**這樣處理過後重碼率是相當低的了。  
  
有用文件集：  
中央研究院文獻處理實驗室所提供的開源文字構型數據： http://cdp.sinica.edu.tw/hanzi/cdphanzi.htm  
深藍詞庫轉換： http://studyzy.cnblogs.com/ http://code.google.com/p/imewlconverter/downloads/list  
OpenVanilla: http://openvanilla.googlecode.com/svn/trunk/Modules/SharedData/  
Unihan: http://www.unicode.org/Public/UNIDATA/Unihan.zip  
OpenCC: http://code.google.com/p/opencc/ https://github.com/BYVoid/OpenCC  
Rimime: http://code.google.com/p/rimeime/downloads/list  
VimIM: http://code.google.com/p/vimim/downloads/list  
Gcin: http://cle.linux.org.tw/trac/wiki/GcinTables  
CEDICT: http://www.mdbg.net/chindict/chindict.php?page=cedict  
我的一些收集和整理： http://code.google.com/p/flyime/downloads/list  
  
### 附記
74402 條四角號碼數據分析：  
號	頻率	首碼頻率  
0	43948	4500  
1	52890	7163  
2	65603	14161  
3	26660	7073  
4	48269	13067  
5	16141	5141  
6	27976	6948  
7	48869	7150  
8	25119	5766  
9	17539	3433  
  
52363 條拼音數據分析：  
聲調	頻率  
陰平	11643  
陽平	13716  
上聲	8484  
去聲	17912  
輕聲	608  
  
70217 條筆畫數據分析：  
筆	頻率	首筆頻率  
橫	302428	20582  
豎	188824	12351  
撇	153495	17026  
點	174815	13675  
折	168601	6583  
  
鍵位如何取捨，呼之欲出。